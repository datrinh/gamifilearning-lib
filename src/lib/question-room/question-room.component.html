<section
  (keyup)="onKey($event)"
  class="content"
  *ngIf="currentInstance"
  tabindex="-1"
>
  <div class="progressbar-container">
    <span class="progress-label">{{ activeIndex }} / {{ maxProgress }}</span>

    <mat-progress-bar
      mode="determinate"
      value="{{ (activeIndex / maxProgress) * 100 }}"
    ></mat-progress-bar>
    <div *ngFor="let reward of rewards">
      <mat-icon
        [@unlockReward]="reward.unlocked"
        class="reward-icon"
        [ngClass]="{ unlocked: reward.unlocked }"
        [ngStyle]="{ 'left.%': reward.position }"
        (click)="claimReward(reward.unlocked)"
        matTooltip="Not unlocked yet!"
        [matTooltipDisabled]="reward.unlocked"
        >{{ reward.icon }}</mat-icon
      >
    </div>
  </div>

  <mat-card class="text-card">
    <p *ngIf="!isDone(); else done" [@fadeIn]="activeIndex">
      {{ currentInstance.text }}
    </p>
    <ng-template #done>
      <div
        *ngIf="!clicked; else charts"
        class="spinner-container"
        (click)="clicked = true"
      >
        <mat-spinner></mat-spinner>
        <p>Verarbeite Daten...</p>
      </div>
    </ng-template>

    <ng-template #charts>
      <!-- <app-chart></app-chart> -->
      <img
        src="https://media.giphy.com/media/nEMmyUp4hl1QOzovKh/giphy.gif"
        alt="Thanks!"
      />
    </ng-template>
  </mat-card>

  <mat-card class="question-card" *ngIf="!isDone()">
    <mat-card-header class="question-text">
      <mat-card-title>
        <span
          [innerHtml]="
            currentInstance.toBeLabeled[currentQuestion].question.questionId
              | translate
          "
        ></span>
      </mat-card-title>
    </mat-card-header>
    <mat-card-content class="answer-buttons-container">
      <button
        mat-button
        class="answer-button"
        *ngFor="
          let answer of currentInstance.toBeLabeled[currentQuestion].question
            .possibleAnswers
        "
        (click)="submitAnswer(answer)"
      >
        {{ answer | translate }}
      </button>
    </mat-card-content>
  </mat-card>
</section>
